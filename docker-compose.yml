services:
  openclaw-gateway:
    image: coollabsio/openclaw:latest
    container_name: xianyu-openclaw
    ports:
      - "${OPENCLAW_WEB_PORT:-8080}:8080"
    volumes:
      - ./skills:/home/node/.openclaw/workspace/skills
      - ./src:/home/node/.openclaw/workspace/src
      - ./config:/home/node/.openclaw/workspace/config
      - ./data:/home/node/.openclaw/workspace/data
      - ./requirements.txt:/home/node/.openclaw/workspace/requirements.txt
      - ./scripts/init.sh:/app/config/init.sh
      - openclaw-state:/home/node/.openclaw
    env_file:
      - .env
    environment:
      - HOME=/home/node
      - TERM=xterm-256color
      - OPENCLAW_GATEWAY_TOKEN=${OPENCLAW_GATEWAY_TOKEN:-}
      - OPENCLAW_CUSTOM_INIT=/app/config/init.sh
    init: true
    restart: unless-stopped
    healthcheck:
      test: ["CMD", "curl", "-sf", "http://127.0.0.1:8080/healthz"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 30s

volumes:
  openclaw-state:
